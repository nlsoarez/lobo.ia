# Configuracao do Lobo IA - Sistema de Trading Autonomo de Criptomoedas
# Versao: 4.2 - Crypto Only (24/7)

# Configuracoes de Criptomoedas (24/7)
crypto:
  # Ativar trading de criptomoedas
  enabled: true

  # Criptos principais a monitorar
  symbols:
    - BTC-USD
    - ETH-USD
    - SOL-USD
    - BNB-USD
    - XRP-USD
    - ADA-USD
    - AVAX-USD
    - DOT-USD
    - LINK-USD
    - MATIC-USD

  # Numero de criptos top para analisar
  top_coins: 20

  # Intervalo de analise (1h recomendado para crypto)
  interval: "1h"
  period: "30d"

  # Cache em minutos
  cache_minutes: 5

  # Capital para crypto (em USD)
  capital: 1000.0

  # Exposicao por trade
  exposure: 0.10  # 10% por trade

  # Limites de exposicao
  min_exposure: 0.05  # Minimo 5%
  max_exposure_per_trade: 0.20  # Maximo 20%

  # Exposicao maxima total
  max_total_exposure: 0.80  # 80%

  # Numero maximo de posicoes
  max_positions: 8

  # Valor minimo por trade em USD
  min_trade_value: 50.0

  # Corretora de crypto
  broker: "binance"

# Configuracoes do Scanner de Mercado Crypto
scanner:
  enabled: true
  top_coins: 20
  min_avg_volume: 1000000
  min_price: 0.001
  max_price: 100000.0
  max_workers: 10
  cache_minutes: 15
  print_report: false

  # Pesos para ranking
  weights:
    signal_strength: 0.30
    volume_score: 0.20
    trend_score: 0.25
    volatility_score: 0.15
    momentum_score: 0.10

# Configuracoes de Estrategia
strategy:
  indicators:
    rsi_period: 14
    rsi_oversold: 30
    rsi_overbought: 70
    ema_period: 21
    ema_fast: 9
    ema_slow: 21

  min_signal_strength: 0.6

# Configuracoes de Dados
data:
  period: "30d"
  interval: "1h"
  cache_ttl: 300
  request_timeout: 30
  max_retries: 3
  retry_delay: 2

# Configuracoes de Blacklist automatica
blacklist:
  max_fails: 3
  duration_hours: 24
  reset_hours: 1

# Configuracoes de Coleta Paralela
parallel_fetcher:
  max_workers: 5
  timeout: 10.0
  max_concurrent: 10

# Configuracoes de Cache Inteligente
cache:
  memory_size: 100
  memory_ttl: 300
  disk_enabled: true
  disk_dir: "/tmp/lobo_cache"
  disk_ttl_hours: 24

# Configuracoes de Health Monitor
health:
  latency_warning_ms: 2000
  latency_critical_ms: 5000
  min_success_rate: 0.7

# Configuracoes do Otimizador de Portfolio
optimizer:
  max_holding_hours: 72
  stagnation_threshold: 0.5
  stagnation_hours: 24
  partial_tp_pct: 3.0
  partial_tp_close: 50
  max_loss_pct: 5.0

# Configuracoes do Validador de Sinais
validator:
  min_confidence: 0.50
  weights:
    rsi: 0.20
    volume: 0.20
    trend: 0.25
    macd: 0.20
    support_resistance: 0.15

  rsi_oversold: 30
  rsi_overbought: 70
  volume_threshold: 1.5

# Configuracoes de Risco
risk:
  stop_loss: 0.02
  take_profit: 0.05
  max_drawdown: 0.10
  trailing_stop_activation: 0.03
  trailing_stop_distance: 0.015

# Configuracoes de Banco de Dados
database:
  db_name: "trades.db"
  auto_backup: true
  backup_interval_hours: 24

# Configuracoes de Logging
logging:
  level: "INFO"
  log_dir: "logs"
  log_file_format: "lobo_{date}.log"
  max_file_size_mb: 10
  backup_count: 5
  console_output: true

# Configuracoes de Aprendizado
learning:
  enabled: true
  min_trades_for_evaluation: 10
  evaluation_frequency: 20
  metrics:
    - win_rate
    - profit_factor
    - sharpe_ratio
    - max_drawdown
    - avg_profit_per_trade

# Configuracoes de Execucao
execution:
  mode: "simulation"
  simulate_slippage: 0.001
  simulate_fees: 0.001
  execution_delay: 1

# Configuracoes de Corretoras
brokers:
  crypto:
    provider: "simulation"
    # api_key: ""
    # api_secret: ""
    # testnet: true

# Configuracoes de APIs de dados
apis:
  coinmarketcap:
    enabled: true
    # API Key - configure via variavel de ambiente CMC_API_KEY

# Configuracoes de Notificacao
notifications:
  enabled: false
  email: ""
  telegram_token: ""
  telegram_chat_id: ""

# ==================== CONFIGURACOES V4.3 CORRECOES CRITICAS ====================

# V4.3: Trade Limit Manager - Controle RIGOROSO de limites
trade_limits:
  # Limite normal de trades diários
  max_daily_trades: 20

  # Limite em modo emergência
  emergency_max_trades: 35

  # Alertar quando restarem X trades
  alert_threshold: 3

# V4.3: Filtros Adaptativos por Regime de Mercado
adaptive_filters:
  enabled: true

  # Configurações por regime
  bull:
    min_score: 40
    max_rsi: 70
    min_rsi: 30
    min_volume_ratio: 1.0

  bear:
    min_score: 50        # Mais restritivo em bear
    max_rsi: 40          # Apenas oversold
    min_rsi: 10
    min_volume_ratio: 1.2

  lateral:
    min_score: 45
    max_rsi: 65
    min_rsi: 35
    min_volume_ratio: 1.1

  volatile:
    min_score: 55
    max_rsi: 60
    min_rsi: 40
    min_volume_ratio: 1.3

# V4.3: Timeout Dinâmico baseado em TP/SL
dynamic_timeout:
  enabled: true

  # Timeout base = TP% / ratio
  base_timeout_ratio: 0.5   # TP 2% = 1h timeout

  # Limites de timeout
  min_timeout_hours: 0.5    # Mínimo 30 min
  max_timeout_hours: 4.0    # Máximo 4 horas

  # Multiplicadores por nível de sinal
  level_multipliers:
    STRONG_OVERRIDE: 1.5
    STRONG: 1.3
    MODERATE: 1.0
    WEAK: 0.7

# V4.3: Smart Trailing Stop
smart_trailing:
  enabled: true

  # Distância do trailing (abaixo do pico)
  trailing_distance_pct: 0.5

  # Níveis de ativação por tipo de sinal
  activation_levels:
    STRONG_OVERRIDE: 1.0   # Ativa após 1% de lucro
    STRONG: 1.5            # Ativa após 1.5%
    MODERATE: 2.0          # Ativa após 2%
    WEAK: 2.5              # Ativa após 2.5%

# V4.3: Validação Rigorosa de STRONG_OVERRIDE
strong_override_validation:
  enabled: true

  # Critérios mínimos
  min_score: 65
  rsi_oversold: 30
  rsi_overbought: 70
  min_volume_ratio: 1.5
  min_confirmed_indicators: 2

  # Requer alinhamento com regime
  require_regime_alignment: true

# ==================== CONFIGURACOES V4.2 EMERGENCIA ====================

# Modo Emergencia - Override de limites durante crises
emergency:
  # Ativar modo emergencia automatico
  enabled: true

  # Duracao maxima do modo emergencia (horas)
  max_duration_hours: 6

  # Multiplicadores de limites durante emergencia
  trade_limit_multiplier: 1.75      # Aumenta limite de trades em 75%
  position_size_multiplier: 0.70    # Reduz tamanho de posicao em 30%
  filter_relaxation_percent: 40     # Relaxa filtros em 40%

  # Limites de trades
  max_trades: 35                    # Maximo durante emergencia
  max_positions_override: 7         # Maximo de posicoes durante emergencia

  # Sinais criticos (bypass de limites)
  critical_signals:
    min_score: 65                   # Score minimo para sinal critico
    max_rsi: 20                     # RSI maximo (oversold extremo)
    min_volume_ratio: 1.5           # Volume minimo acima da media
    allowed_override_trades: 5      # Trades adicionais permitidos com bypass

  # Triggers para ativacao automatica
  triggers:
    hours_without_entry: 4          # Horas sem entrada para ativar
    consecutive_losses: 3           # Perdas consecutivas
    daily_loss_threshold: -0.02     # Perda diaria para ativar (-2%)

  # Sistema de alertas
  alerts:
    enable_metric_alerts: true      # Alertas de metricas inconsistentes
    enable_opportunity_alerts: true # Alertas de oportunidades perdidas
    notification_channels:          # Canais de notificacao
      - log
      - dashboard
    rsi_extreme_minutes: 30         # Minutos de RSI extremo para alerta

# Limites Diarios de Trading
daily_limits:
  # Limites normais
  regular:
    max_trades: 20
    max_positions: 5
    max_daily_loss_percent: 2.0
    target_profit_percent: 5.0      # Meta diaria de 5%
    max_profit_percent: 8.0         # Maximo para parar (8%)

  # Limites em modo emergencia
  emergency:
    max_trades: 35
    max_positions: 7
    max_daily_loss_percent: 3.0
    critical_trade_allowance: 5     # Trades com bypass

# Circuit Breakers - Protecao contra perdas
circuit_breakers:
  enabled: true
  levels:
    - losses: 2
      action: "reduce_50"           # Reduz exposicao em 50%
      multiplier: 0.5
    - losses: 3
      action: "pause_5min"          # Pausa por 5 minutos
      pause_minutes: 5
    - losses: 4
      action: "pause_15min"         # Pausa por 15 minutos
      pause_minutes: 15
    - losses: 5
      action: "stop_trading"        # Para operacoes
      stop: true

